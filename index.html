<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DNTN KINH DOANH VÀNG BẠC - NƠI DUYÊN</title>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;800&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: linear-gradient(135deg, #0f0f23, #1a1a3a);
      font-family: 'Open Sans', sans-serif;
      color: white;
      overflow: hidden;
    }

    .wrapper {
      width: 100vw;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    /* Banner nhỏ lại */
    .header {
      flex: 0 0 20%;
      display: flex;
      justify-content: center;
      align-items: center;
      background: black;
    }
    .banner {
      max-height: 100%;
      max-width: 95%;
      object-fit: contain;
    }

    /* Main content */
    .main-content {
      flex: 1;
      display: flex;
      gap: 15px;
      padding: 10px;
    }

    /* Gold section */
    .gold-section {
      flex: 3;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .title-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 5px 15px;
    }
    .gold-title {
      font-size: 1.6vw;
      font-weight: 800;
      color: #FFF200;
    }
    .time-display {
      font-size: 1.8vw;
      color: #f4dc60;
      font-family: 'Roboto Mono', monospace;
    }
    .gold-table-container {
      flex: 1;
      background: rgba(255,255,255,0.08);
      border-radius: 12px;
      border: 2px solid rgba(244,220,96,0.4);
      overflow: hidden;
      display: flex;
    }
    .gold-table {
      width: 100%;
      height: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }
    .gold-table th,
    .gold-table td {
      border: 1px solid rgba(255,255,255,0.2);
      text-align: center;
       height: calc(100% / 6);
  padding: 0;
  line-height: 1.2;
    }
  
    .gold-table th {
      background: linear-gradient(135deg, #003cff, #007bff);
      color: #fff;
     font-size: min(5vh, 3vw); 
    }
    .gold-table td {
      background: linear-gradient(135deg,#e2d818,#FFF200);
     font-size: min(4.5vh, 2.8vw);  /* chữ nội dung ~4.5% chiều cao màn hình */
  font-weight: 800;
 
    }
    .gold-table td:first-child { color: #FF0000; }
    .gold-table td:not(:first-child) { color: #FF0000; }

    /* Sidebar */
    .calendar-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .calendar-container, .info-container {
      background: rgba(255,255,255,0.08);
      border-radius: 10px;
      padding: 10px;
      border: 2px solid rgba(244,220,96,0.4);
    }
    .lunar-date { font-size: 1vw; color: #f4dc60; text-align: center; }
    .calendar h4 { font-size: 1.2vw; color: #f4dc60; text-align: center; margin-bottom: 5px; }
    .calendar-grid { display: grid; grid-template-columns: repeat(7,1fr); gap: 2px; font-size: 0.9vw; }
    .calendar-header { background: #0056ff; color: #fff; padding: 4px; text-align: center; border-radius: 4px; }
    .calendar-day { color: #f4dc60; text-align: center; padding: 4px; border-radius: 4px; }
    .calendar-day.today { background: #ffd700; color: #000; font-weight: 900; transform: scale(1.1); }

    .wisdom-title { font-size: 1vw; text-align: center; color: #f4dc60; margin: 5px 0; }
    .wisdom-content { font-size: 0.9vw; text-align: center; color: #fff; font-style: italic; }

    .last-updated { font-size: 0.8vw; text-align: center; margin-top: 5px; }
    .sync-status { display: flex; justify-content: center; gap: 5px; margin-top: 5px; }
    .sync-indicator { width: 10px; height: 10px; border-radius: 50%; }
    .sync-indicator.online { background: #00ff00; box-shadow: 0 0 8px #00ff00; }
    .sync-indicator.offline { background: #ff0000; box-shadow: 0 0 8px #ff0000; }

    /* Responsive laptop */
    @media (max-width: 1366px) {
      .gold-title { font-size: 1.2rem; }
      .time-display { font-size: 1.3rem; }
      .gold-table th { font-size: 1rem; }
      .gold-table td { font-size: 0.9rem; }
    }

    /* Responsive mobile */
    @media (max-width: 768px) {
      .header { flex: 0 0 18%; }
      .main-content { flex-direction: column; }
      .gold-section, .calendar-section { flex: none; width: 100%; }
      .gold-title { font-size: 1.1rem; }
      .time-display { font-size: 1.2rem; }
      .gold-table th { font-size: 0.9rem; }
      .gold-table td { font-size: 0.85rem; }
    }
  </style>
</head>
<body>
<div class="wrapper">
  <div class="container">

    <!-- Banner -->
    <div class="header">
      <img class="banner" src="https://raw.githubusercontent.com/s2voks2-wq/tiemvangnoiduyen/main/banner.png" alt="Banner cửa hàng">
    </div>

    <!-- Nội dung chính -->
    <div class="main-content">
      <!-- Bảng giá vàng -->
      <div class="gold-section">
        <div class="title-bar">
          <h1 class="gold-title">GIÁ VÀNG HÔM NAY</h1>
          <div class="digital-clock">
            <div class="time-display" id="digitalTime">00:00:00</div>
          </div>
        </div>
        <div class="gold-table-container">
          <div id="tableContainer">
            <div class="loading">Đang tải dữ liệu</div>
          </div>
        </div>
      </div>

      <!-- Sidebar -->
      <div class="calendar-section">
        <div class="calendar-container">
          <div class="lunar-date" id="lunarDate"></div>
          <div class="calendar">
            <h4 id="calendarMonth"></h4>
            <div class="calendar-grid" id="calendarGrid"></div>
          </div>
          <div class="folk-wisdom">
            <div class="wisdom-title">Ca Dao Tục Ngữ</div>
            <div class="wisdom-content" id="folkWisdom"></div>
          </div>
        </div>

        <div class="info-container">
          <div class="last-updated" id="lastUpdated"></div>
          <div class="sync-status">
            <div class="sync-indicator" id="syncIndicator"></div>
            <span id="syncText">Connecting...</span>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
  const SHEET_ID = '1b5u3h4dl1R_qitdExmbDRn8GdPk3jX6skW9XiF_OJWQ';
  const API_KEY = 'AIzaSyABuWz8zGYpfbuV4-Ht2aEqnXEzD9k8FRE';
  const SHEET_NAME = 'Sheet1';

  function formatNumber(num) {
    if (!num || num === '') return '';
    return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
  }

  async function fetchGoldData() {
    const tableContainer = document.getElementById('tableContainer');
    try {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}?key=${API_KEY}`;
      const response = await fetch(url);
      if (!response.ok) throw new Error(`HTTP ${response.status}`);
      const data = await response.json();

      if (data.values && data.values.length > 0) {
        renderTable(data.values);
        updateLastUpdatedTime();
      } else throw new Error("Không có dữ liệu");
    } catch (e) {
      if (tableContainer) tableContainer.innerHTML = '<div class="error">Không thể tải dữ liệu</div>';
    }
  }

  function renderTable(data) {
    const tableContainer = document.getElementById('tableContainer');
    if (!tableContainer || !data || data.length === 0) return;

    let html = '<table class="gold-table">';
    if (data[0]) {
      html += '<thead><tr>';
      data[0].forEach(header => {
        html += `<th>${header}</th>`;
      });
      html += '</tr></thead>';
    }

    html += '<tbody>';
    const maxRows = 5; // chỉ hiển thị 5 mục
    for (let i = 1; i < Math.min(data.length, maxRows + 1); i++) {
      const row = data[i];
      html += '<tr>';
      row.forEach((cell, idx) => {
        const formattedCell = (idx > 0 && cell) ? formatNumber(cell) : cell;
        html += `<td>${formattedCell || ''}</td>`;
      });
      html += '</tr>';
    }
    html += '</tbody></table>';

    tableContainer.innerHTML = html;
  }

  function updateLastUpdatedTime() {
    const el = document.getElementById('lastUpdated');
    if (el) {
      const now = new Date();
      el.textContent = "Cập nhật: " + now.toLocaleString('vi-VN');
    }
  }

  function updateDigitalClock() {
    const now = new Date();
    const h = String(now.getHours()).padStart(2,'0');
    const m = String(now.getMinutes()).padStart(2,'0');
    const s = String(now.getSeconds()).padStart(2,'0');
    document.getElementById('digitalTime').textContent = `${h}:${m}:${s}`;
  }

  function updateCalendar() {
    const now = new Date();
    const year = now.getFullYear();
    const month = now.getMonth();
    const daysInMonth = new Date(year, month+1, 0).getDate();
    const firstDay = new Date(year, month, 1).getDay();
    const today = now.getDate();

    document.getElementById('calendarMonth').textContent = `Tháng ${month+1} ${year}`;

    let html = '';
    ['CN','T2','T3','T4','T5','T6','T7'].forEach(d => html+=`<div class="calendar-header">${d}</div>`);
    for (let i=0;i<firstDay;i++) html += `<div class="calendar-day"></div>`;
    for (let d=1;d<=daysInMonth;d++) {
      html += `<div class="calendar-day ${d===today?'today':''}">${d}</div>`;
    }
    document.getElementById('calendarGrid').innerHTML = html;
  }

  function updateFolkWisdom() {
    const wisdoms = [
      "Ăn quả nhớ kẻ trồng cây","Có công mài sắt, có ngày nên kim",
      "Đi một ngày đàng, học một sàng khôn","Lá lành đùm lá rách",
      "Thương người như thể thương thân","Uống nước nhớ nguồn"
    ];
    const day = new Date().getDate();
    document.getElementById('folkWisdom').textContent = wisdoms[day % wisdoms.length];
  }

  function init() {
    fetchGoldData();
    updateDigitalClock();
    updateCalendar();
    updateFolkWisdom();
    setInterval(updateDigitalClock,1000);
    setInterval(fetchGoldData,60000);
  }
  document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
